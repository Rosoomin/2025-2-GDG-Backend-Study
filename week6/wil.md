500 Internal Error : 클라이언트가 아닌 서버의 잘못  
5xx 에러 : 어플리케이션 자체에 문제가 발생 or 의도치 않은 예외가 발생  

클라이언트의 문제라면 -> 4xx 라고 뜸  

---

## 유효성 검사
- 요청으로 들어오는 데이터가 올바른 형식인지 검사하는 것  
- Spring : DTO에서 유효성을 검사  
- 올바른 형식에 주목  
  -> 유효성 검사 = 입력 데이터 형식을 검사  
  -> 존재하는 member인지 여부 판단 못함. (DB 조회를 통해 판단 필요)

### 어떻게 하나?
- 외부 의존성을 추가  
- 수정 후 build.gradle 리로드 필요  
- 유효성 검사 어노테이션 적용 : `@NotNull`, `@Size`, `@Pattern` 사용  
- Controller 메서드에 `@Valid` 추가  

유효성 검사 어노테이션 : 제약 사항 & 에러 메시지 명시  
`@Valid` -> 제약 조건에 맞는지 검사  

---

## 기존 updateInfo의 문제점
엔티티 계층의 메서드가 두 가지 책임을 가지고 있음  
1. 도메인 모델 책임 : 데이터와 도메인 로직(값 설정)  
2. 비즈니스 로직 책임 : "어떤 필드를 업데이트할지 결정" (null 체크를 통한 조건부 업데이트)  
-> SOLID 원칙 중 SRP(단일 책임 원칙) 위반  

### 리팩토링
- 외부 동작은 변경하지 않으면서 '내부 구조를 개선'하는 과정  
- 기능(로직) 변경 사항 없음  
- 가독성, 유지보수성, 확장성을 높이고 버그를 줄이기 위함  

---

## 예외 처리
- 잘못 들어간게 무엇인지 알 수 없음  
-> 에러가 발생했을 때, 원인을 알려주는 에러 메시지를 담도록 직접 응답 객체 생성  

---

## 예외 처리.zip

### 1. Global Exception Handler
- 공통 예외 처리 핸들러(member, order, product..)  
- 에러 정보 반환용 DTO  
- AOP(관점 지향 프로그래밍)

### 2. 커스텀 예외 처리
- 커스텀 예외 클래스, RuntimeException을 상속  
- Global Exception Handler에 등록 -> 에러 원인 명확히 알 수 있음  

### 3. 에러 메시지 클래스
- 예외 메시지 문자열 중복 사용됨 -> 추가/수정 힘듦  
- 상수로 정의  

---

## Global Exception Handler(전역 예외 핸들러)
- Spring에서 제공  
- 예외 종류에 따라 response를 설정 가능  
- Global Exception을 처리 = 스프링 애플리케이션 전역의 모든 에러 처리 방법을 결정  

`@ExceptionHandler(A.class)`  
A 타입 에러 발생?  
-> 해당 에러 타입을 다루는 핸들러가 Controller 메서드 대신 Response Body를 생성 & 응답  

`@ControllerAdvice`  
- 모든 컨트롤러에서 발생하는 예외를 중앙에서 처리  
= 모든 컨트롤러의 공통 관심사(에러처리)를 별도의 클래스로 분리하여 구현  

---

## AOP(Aspect-Oriented Programming)
- 관점 지향 프로그래밍  
- 객체 지향 프로그래밍 보완 개념  

### OOP(객체 지향) vs AOP(관점 지향)

**OOP = 핵심 기능을 모듈화**  
- 비즈니스 로직을 클래스와 메서드로 구조화  
- 예 : 회원 관리, 주문 처리, 상품 관리 등  

**AOP = 부가 기능을 모듈화**  
- 여러 클래스에 걸쳐 반복되는 공통 기능을 분리  
- 예 : 로깅, 트랜잭션, 보안, 예외 처리 등  

---

## 커스텀 예외 처리
- 커스텀 예외 클래스 생성  
- 실행 중 예외는 RuntimeException 상속  
- 커스텀 예외 처리 핸들러 생성  
- handlerNotFoundException  

---

## 예외 메시지 클래스
- 예외 메시지 문자열 중복 사용됨 -> 추가/수정하기 힘듦  
- 예외 메시지를 상수로 정의  
- 서비스에 작성한 에러 메시지를 상수로 변경  

---

## API 문서화
- API 사용 설명서 공유  
- 백엔드 API 명세를 문서로 공유  
- 클라이언트(프론트엔드)와 소통/협업 시 API 문서 공유  

---

## 어떻게 사용??
-> Swagger 사용  

1. **spring doc 사용** -> OpenAPI 규격의 API 문서 생성  
   - OpenAPI : API 표준 명세  

2. **Swagger UI 사용** -> API 문서에 Swagger 디자인 적용  

### API 문서화 작업 위한 어노테이션
- `@Tag` : API 그룹화 (컨트롤러 레벨)  
- `@Operation` : API의 요약과 설명 (메서드 레벨)  
- `@ApiResponse` : 단일 응답 코드 설명 (메서드 레벨)  
